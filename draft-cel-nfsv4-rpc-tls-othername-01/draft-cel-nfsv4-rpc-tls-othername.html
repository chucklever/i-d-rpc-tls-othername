<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Han,Hiragana,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Remote Procedure Call Identity Squashing via x.509 Certificate Fields</title>
<meta content="Rick Macklem" name="author">
<meta content="Chuck Lever" name="author">
<meta content="
       This document extends RPC-with-TLS, as described in  , so
that a client's x.509 certificate may carry instructions to the RPC
server to execute all RPC transactions from that client as a single
user identity. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="x.509" name="keyword">
<meta content="SubjectAltName" name="keyword">
<meta content="otherName" name="keyword">
<meta content="NFS" name="keyword">
<meta content="SunRPC" name="keyword">
<meta content="draft-cel-nfsv4-rpc-tls-othername-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-cel-nfsv4-rpc-tls-othername.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SunRPC x.509 Identity Squashing</td>
<td class="right">November 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Macklem &amp; Lever</td>
<td class="center">Expires 6 May 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network File System Version 4</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-cel-nfsv4-rpc-tls-othername-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-11-02" class="published">2 November 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-05-06">6 May 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Macklem</div>
<div class="org">FreeBSD</div>
</div>
<div class="author">
      <div class="author-name">C. Lever, <span class="editor">Ed.</span>
</div>
<div class="org">Oracle</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Remote Procedure Call Identity Squashing via x.509 Certificate Fields</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document extends RPC-with-TLS, as described in <span>[<a href="#RFC9289" class="cite xref">RFC9289</a>]</span>, so
that a client's x.509 certificate may carry instructions to the RPC
server to execute all RPC transactions from that client as a single
user identity.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://chucklever.github.io/i-d-rpc-tls-othername/#go.draft-cel-nfsv4-rpc-tls-othername.html">https://chucklever.github.io/i-d-rpc-tls-othername/#go.draft-cel-nfsv4-rpc-tls-othername.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-cel-nfsv4-rpc-tls-othername/">https://datatracker.ietf.org/doc/draft-cel-nfsv4-rpc-tls-othername/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        nfsv4 Working Group mailing list (<span><a href="mailto:nfsv4@ietf.org">mailto:nfsv4@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/nfsv4/">https://mailarchive.ietf.org/arch/browse/nfsv4/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/nfsv4/">https://www.ietf.org/mailman/listinfo/nfsv4/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/chucklever/i-d-rpc-tls-othername">https://github.com/chucklever/i-d-rpc-tls-othername</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 May 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-background" class="internal xref">Background</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-problem-statement" class="internal xref">Problem Statement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-summary-of-proposed-solutio" class="internal xref">Summary of Proposed Solution</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-x509-certificate-subjectalt" class="internal xref">x.509 Certificate SubjectAltName Field</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-server-processing-of-othern" class="internal xref">Server Processing of otherName Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-server-processing" class="internal xref">Server Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-interoperability-with-non-s" class="internal xref">Interoperability with Non-Supporting Servers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-auth_sys-identities" class="internal xref">AUTH_SYS Identities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-othername-oid-for-auth_sys" class="internal xref">otherName OID for AUTH_SYS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-format-of-the-othername-val" class="internal xref">Format of the otherName Value</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-gss-api-principals" class="internal xref">GSS-API Principals</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-othername-oid-for-gss-api-p" class="internal xref">otherName OID for GSS-API Principals</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-format-of-the-othername-valu" class="internal xref">Format of the otherName Value</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-nfsv4-user-domain-string-id" class="internal xref">NFSv4 User @ Domain String Identities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-othername-oid-for-string-id" class="internal xref">otherName OID for String Identities</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-format-of-the-othername-value" class="internal xref">Format of the otherName Value</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-extending-this-mechanism" class="internal xref">Extending This Mechanism</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-client-certificate-generati" class="internal xref">Client Certificate Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-choosing-an-identity-format" class="internal xref">Choosing an Identity Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-populating-identity-fields" class="internal xref">Populating Identity Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-certificate-validity-period" class="internal xref">Certificate Validity Period</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-freebsd-nfs-server-and-clie" class="internal xref">FreeBSD NFS Server and Client</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-general-security-considerat" class="internal xref">General Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-identity-squashing-and-auth" class="internal xref">Identity Squashing and Authorization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-trust-in-the-certificate-au" class="internal xref">Trust in the Certificate Authority</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-authorization-decisions" class="internal xref">Authorization Decisions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-7.2.3" class="auto internal xref">7.2.3</a>.  <a href="#name-name-canonicalization" class="internal xref">Name Canonicalization</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-session-binding" class="internal xref">Session Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-revocation" class="internal xref">Revocation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-multiple-identity-formats" class="internal xref">Multiple Identity Formats</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-smi-security-for-pkix-modul" class="internal xref">SMI Security for PKIX Module Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-smi-security-for-pkix-other" class="internal xref">SMI Security for PKIX Other Name Forms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-asn1-modules" class="internal xref">ASN.1 Modules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-the-rpcauthsysuser" class="internal xref">The RpcAuthSysUser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-the-rpcgssuser" class="internal xref">The RpcGssUser</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-the-rpcnfsv4user" class="internal xref">The RpcNfsv4User</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-certificate-examples" class="internal xref">Certificate Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-nfsv4-principal-example" class="internal xref">NFSv4 Principal Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-gss-api-exported-name-examp" class="internal xref">GSS-API Exported Name Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-rpc-auth_sys-example" class="internal xref">RPC AUTH_SYS Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-complete-certificate-exampl" class="internal xref">Complete Certificate Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-internationalized-domain-na" class="internal xref">Internationalized Domain Name Example</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#appendix-B.6" class="auto internal xref">B.6</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6.2.1">
                    <p id="section-toc.1-1.11.2.6.2.1.1"><a href="#appendix-B.6.1" class="auto internal xref">B.6.1</a>.  <a href="#name-valid-nfsv4principal-test-c" class="internal xref">Valid NFSv4Principal Test Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6.2.2">
                    <p id="section-toc.1-1.11.2.6.2.2.1"><a href="#appendix-B.6.2" class="auto internal xref">B.6.2</a>.  <a href="#name-valid-rpcauthsys-test-cases" class="internal xref">Valid RPCAuthSys Test Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6.2.3">
                    <p id="section-toc.1-1.11.2.6.2.3.1"><a href="#appendix-B.6.3" class="auto internal xref">B.6.3</a>.  <a href="#name-invalid-test-cases" class="internal xref">Invalid Test Cases</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="background">
<section id="section-1.1">
        <h3 id="name-background">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-background" class="section-name selfRef">Background</a>
        </h3>
<p id="section-1.1-1">The Remote Procedure Call version 2 protocol (RPC, for short) has been
a Proposed Standard for three decades (see <span>[<a href="#RFC5531" class="cite xref">RFC5531</a>]</span> and its
antecedents).
Several important upper layer protocols, such as the family of Network
File System protocols (most recently described in <span>[<a href="#RFC8881" class="cite xref">RFC8881</a>]</span> are based
on RPC.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">In 2022, the IETF published <span>[<a href="#RFC9289" class="cite xref">RFC9289</a>]</span>, which specifies a mechanism
by which RPC transactions can be cryptographically protected during
transit. This protection includes maintaining confidentiality and
integrity, and the authentication of the communicating peers.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="problem-statement">
<section id="section-1.2">
        <h3 id="name-problem-statement">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-problem-statement" class="section-name selfRef">Problem Statement</a>
        </h3>
<p id="section-1.2-1"><span><a href="https://rfc-editor.org/rfc/rfc9289#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9289" class="cite xref">RFC9289</a>]</span> states that:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">RPC user authentication is not affected by
the use of transport layer security.  When a client presents a TLS
peer identity to an RPC server, the protocol extension described in
the current document provides no way for the server to know whether
that identity represents one RPC user on that client or is shared
amongst many RPC users.  Therefore, a server implementation cannot
utilize the remote TLS peer identity to authenticate RPC users.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-3">Mobile devices such as laptops are typically used by a single user and
do not have a fixed, well known IP host address or fully qualified DNS name.
The lack of a well known fixed IP host address or fully qualified DNS name
weakens the verification checks that may be done on the client's X.509
certificate by the server.  As such, this extension allows the client to be
restricted to a single user entity on the server, limiting the scope of risk
associated with allowing access to the server.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">When a service is running in a dedicated VM or container, it often
runs as a single assigned user identity. Handling this user identity
using Kerberos is problematic, since Kerberos TGTs typically expire
in a matter of hours and the service is typically a long running task.
This extension allows the client to specify the single assigned user
identity to the server in a manner that will not expire for a significant
period of time.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">When an RPC server replaces incoming RPC user identities with a single
user identity, for brevity we refer to this as "identity squashing".<a href="#section-1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-of-proposed-solution">
<section id="section-1.3">
        <h3 id="name-summary-of-proposed-solutio">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-summary-of-proposed-solutio" class="section-name selfRef">Summary of Proposed Solution</a>
        </h3>
<p id="section-1.3-1">In the interest of enabling the independent creation of interoperating
implementations of RPC identity squashing, this document proposes the
use of the x.509 SubjectAltName otherName field to carry a RPC user
identity.
For these user squashing instructions,
this document establishes a fixed object identifier
carried in the "type-id" part of the otherName field,
and specifies the format of the "value" part of the otherName
field when "type-id" carries the new object identifier.
The document also provides normative guidance on how the "value"
is to be interpreted by RPC servers.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements-language">
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="x509-certificate-subjectaltname-field">
<section id="section-3">
      <h2 id="name-x509-certificate-subjectalt">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-x509-certificate-subjectalt" class="section-name selfRef">x.509 Certificate SubjectAltName Field</a>
      </h2>
<p id="section-3-1">As specified in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.6" class="relref">Section 4.2.1.6</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3-2.1">
          <p id="section-3-2.1.1">The subjectAltName <span class="bcp14">MAY</span> carry additional name types through the use of
the otherName field.  The format and semantics of the name are
indicated through the OBJECT IDENTIFIER in the type-id field.  The
name itself is conveyed as value field in otherName.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-3">A SubjectAltName extension <span class="bcp14">MAY</span> contain multiple entries of different types
(e.g., dNSName, iPAddress, otherName). When processing a certificate for
identity squashing purposes, the server examines only the otherName entries
with type-id values defined in this document. Other SubjectAltName entries
are used for their normal purposes (such as hostname verification for TLS).<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">This document specifies new uses of the otherName field to carry an
RPC user identity. The receiving system (an RPC server) then
replaces the RPC user, as carried in the RPC header credential and
verifier fields in each RPC request within the TLS session, with the
user identity specified in the certificate used to authenticate that
session.<a href="#section-3-4" class="pilcrow">¶</a></p>
<div id="server-processing-of-othername-fields">
<section id="section-3.1">
        <h3 id="name-server-processing-of-othern">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-server-processing-of-othern" class="section-name selfRef">Server Processing of otherName Fields</a>
        </h3>
<p id="section-3.1-1">When an RPC server receives a client certificate containing a
SubjectAltName extension, it <span class="bcp14">MUST</span> process the otherName fields as
follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-2">
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">The server <span class="bcp14">MUST</span> examine all otherName entries in the SubjectAltName
extension.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">If the server finds an otherName with a type-id that matches one of
the identity squashing OIDs defined in this document (id-on-rpcAuthSys,
id-on-gssExportedName, or id-on-nfsv4Principal), it <span class="bcp14">SHOULD</span> extract
and validate the identity information from that otherName.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">If multiple identity squashing otherName fields are present in the
same SubjectAltName extension, the server <span class="bcp14">MUST</span> reject the certificate
to avoid ambiguity. See <a href="#sec-security-considerations" class="auto internal xref">Section 7</a> for details.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">If the server encounters otherName entries with type-id values it does
not recognize, it <span class="bcp14">MUST</span> ignore those entries and continue processing.
This ensures forward compatibility with future extensions.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.1-2.5">
            <p id="section-3.1-2.5.1">Other types of SubjectAltName entries (dNSName, iPAddress, etc.) are
processed independently and do not affect identity squashing behavior.<a href="#section-3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.1-3">The server performs identity squashing only if it successfully validates
an identity squashing otherName field and authorizes its use for the
authenticated TLS peer.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-processing">
<section id="section-3.2">
        <h3 id="name-server-processing">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-server-processing" class="section-name selfRef">Server Processing</a>
        </h3>
<p id="section-3.2-1">This section provides a non-normative example of how an RPC server
implementation might process identity squashing otherName fields.
Implementers are free to use alternative approaches.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">A typical server processing flow might include these steps:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">During TLS session establishment, extract and validate the client's
X.509 certificate according to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and <span>[<a href="#RFC9289" class="cite xref">RFC9289</a>]</span>.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">If the certificate contains a SubjectAltName extension, examine each
otherName entry to determine if any contain identity squashing type-id
values (id-on-rpcAuthSys, id-on-gssExportedName, or id-on-nfsv4Principal).<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">If exactly one identity squashing otherName is found, extract and parse
the identity information according to the ASN.1 definition for that type-id.
If parsing fails, reject the certificate.<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">Perform authorization checks to determine whether the authenticated TLS
peer is permitted to use the specified identity. This might involve:<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.4.2.1">
                <p id="section-3.2-3.4.2.1.1">Consulting an access control list mapping certificate subjects to
allowed user identities<a href="#section-3.2-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-3.4.2.2">
                <p id="section-3.2-3.4.2.2.1">Verifying that the requested UID/GID values are within acceptable ranges<a href="#section-3.2-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-3.4.2.3">
                <p id="section-3.2-3.4.2.3.1">Validating that the user@domain string matches expected domain patterns<a href="#section-3.2-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2-3.4.2.4">
                <p id="section-3.2-3.4.2.4.1">Checking that the GSS-API mechanism is trusted and the principal is
authorized<a href="#section-3.2-3.4.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-3.2-3.5">
            <p id="section-3.2-3.5.1">If authorization succeeds, associate the extracted identity with the TLS
session state.<a href="#section-3.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.6">
            <p id="section-3.2-3.6.1">For each incoming RPC request on this TLS session, replace the credential
information in the RPC header with the identity extracted from the certificate.
The original credential information in the RPC header is ignored.<a href="#section-3.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.7">
            <p id="section-3.2-3.7.1">Process the RPC request using the squashed identity for all authorization
and access control decisions.<a href="#section-3.2-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-4">Implementations should consider caching the parsed and validated identity
information at TLS session establishment time to avoid repeated parsing
for each RPC request.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interoperability-with-non-supporting-servers">
<section id="section-3.3">
        <h3 id="name-interoperability-with-non-s">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-interoperability-with-non-s" class="section-name selfRef">Interoperability with Non-Supporting Servers</a>
        </h3>
<p id="section-3.3-1">RPC servers that do not implement this specification will not recognize
the otherName OIDs defined in this document. Such servers <span class="bcp14">MUST</span> ignore
unrecognized otherName entries per <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.6" class="relref">Section 4.2.1.6</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
These servers will process RPC requests using the credential information
contained in the RPC header, subject to their normal authentication and
authorization policies. This ensures that clients presenting certificates
with identity squashing otherName fields can interoperate with servers
that do not support this specification, though without identity squashing.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authsys-identities">
<section id="section-3.4">
        <h3 id="name-auth_sys-identities">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-auth_sys-identities" class="section-name selfRef">AUTH_SYS Identities</a>
        </h3>
<div id="othername-oid-for-authsys">
<section id="section-3.4.1">
          <h4 id="name-othername-oid-for-auth_sys">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-othername-oid-for-auth_sys" class="section-name selfRef">otherName OID for AUTH_SYS</a>
          </h4>
<p id="section-3.4.1-1">The otherName OID for AUTH_SYS identities is id-on-rpcAuthSys,
defined in <a href="#sec-authsys-asn1" class="auto internal xref">Appendix A.1</a>.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-the-othername-value">
<section id="section-3.4.2">
          <h4 id="name-format-of-the-othername-val">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-format-of-the-othername-val" class="section-name selfRef">Format of the otherName Value</a>
          </h4>
<p id="section-3.4.2-1">The otherName value for AUTH_SYS identities contains an RPCAuthSys
structure as defined in <a href="#sec-authsys-asn1" class="auto internal xref">Appendix A.1</a>. This structure consists
of a 32-bit unsigned integer specifying a numeric UID, and a sequence
of 32-bit unsigned integers specifying numeric GIDs.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">The use of these integers is further explained in <span>[<a href="#RFC5531" class="cite xref">RFC5531</a>]</span>.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="gss-api-principals">
<section id="section-3.5">
        <h3 id="name-gss-api-principals">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-gss-api-principals" class="section-name selfRef">GSS-API Principals</a>
        </h3>
<div id="othername-oid-for-gss-api-principals">
<section id="section-3.5.1">
          <h4 id="name-othername-oid-for-gss-api-p">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-othername-oid-for-gss-api-p" class="section-name selfRef">otherName OID for GSS-API Principals</a>
          </h4>
<p id="section-3.5.1-1">The otherName OID for GSS-API exported names is id-on-gssExportedName,
defined in <a href="#sec-gss-asn1" class="auto internal xref">Appendix A.2</a>.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-the-othername-value-1">
<section id="section-3.5.2">
          <h4 id="name-format-of-the-othername-valu">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-format-of-the-othername-valu" class="section-name selfRef">Format of the otherName Value</a>
          </h4>
<p id="section-3.5.2-1">The otherName value contains a GSSExportedName structure as defined in
<a href="#sec-gss-asn1" class="auto internal xref">Appendix A.2</a>, consisting of a GSS-API mechanism OID and a
mechanism-specific exported name value as described in <span><a href="https://rfc-editor.org/rfc/rfc2743#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC2743" class="cite xref">RFC2743</a>]</span>.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="nfsv4-user-domain-string-identities">
<section id="section-3.6">
        <h3 id="name-nfsv4-user-domain-string-id">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-nfsv4-user-domain-string-id" class="section-name selfRef">NFSv4 User @ Domain String Identities</a>
        </h3>
<div id="othername-oid-for-string-identities">
<section id="section-3.6.1">
          <h4 id="name-othername-oid-for-string-id">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-othername-oid-for-string-id" class="section-name selfRef">otherName OID for String Identities</a>
          </h4>
<p id="section-3.6.1-1">The otherName OID for NFSv4 user@domain principals is id-on-nfsv4Principal,
defined in <a href="#sec-nfsv4-asn1" class="auto internal xref">Appendix A.3</a>.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-the-othername-value-2">
<section id="section-3.6.2">
          <h4 id="name-format-of-the-othername-value">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-format-of-the-othername-value" class="section-name selfRef">Format of the otherName Value</a>
          </h4>
<p id="section-3.6.2-1">The otherName value contains an NFSv4Principal structure as defined in
<a href="#sec-nfsv4-asn1" class="auto internal xref">Appendix A.3</a>, consisting of a UTF-8 encoded user name, the
literal "@" character, and a UTF-8 encoded domain name, as described in
<span><a href="https://rfc-editor.org/rfc/rfc8881#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC8881" class="cite xref">RFC8881</a>]</span>.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="extending-this-mechanism">
<section id="section-4">
      <h2 id="name-extending-this-mechanism">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-extending-this-mechanism" class="section-name selfRef">Extending This Mechanism</a>
      </h2>
<p id="section-4-1">It is possible that in the future, RPC servers might implement other forms
of RPC user identity, such as Windows Security Identifiers.
This section describes how standards action can extend the mechanism
specified in this document to accommodate new forms of user identity.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Here, we'll provide the base level of general requirements that must be
met, as instructions to future authors. These are to include:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">New identity types must define an ASN.1 module<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">Must request IANA OID allocation<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1">Should provide security considerations specific to that identity type<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.4">
          <p id="section-4-3.4.1">Should provide examples and test vectors<a href="#section-4-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="client-certificate-generation">
<section id="section-5">
      <h2 id="name-client-certificate-generati">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-client-certificate-generati" class="section-name selfRef">Client Certificate Generation</a>
      </h2>
<p id="section-5-1">This section provides non-normative guidance for Certificate Authorities
and administrators who generate client certificates containing identity
squashing otherName fields.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="choosing-an-identity-format">
<section id="section-5.1">
        <h3 id="name-choosing-an-identity-format">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-choosing-an-identity-format" class="section-name selfRef">Choosing an Identity Format</a>
        </h3>
<p id="section-5.1-1">The choice of which identity format to use depends on the deployment
environment:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">RPCAuthSys</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">Appropriate for environments where numeric UIDs and GIDs are the primary
form of user identity, such as traditional UNIX/Linux systems. This format
is compact but requires that UID/GID mappings be consistent between the
certificate and the server's user database.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">GSSExportedName</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">Suitable for environments using GSS-API mechanisms like Kerberos. This
format provides the strongest integration with existing enterprise
authentication infrastructure but requires that servers support the
specific GSS-API mechanism indicated by the nameType OID.<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">NFSv4Principal</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">Recommended for heterogeneous environments or when human-readable
identities are preferred. The user@domain format is familiar to
administrators and supports internationalization, but requires that
servers perform name-to-UID mapping similar to NFSv4 identity mapping.<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="populating-identity-fields">
<section id="section-5.2">
        <h3 id="name-populating-identity-fields">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-populating-identity-fields" class="section-name selfRef">Populating Identity Fields</a>
        </h3>
<p id="section-5.2-1">When generating certificates, consider these guidelines:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-2">
          <dt id="section-5.2-2.1">UID/GID values</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">Ensure that the numeric values in RPCAuthSys correspond to valid entries
in the server's user database. Avoid using privileged UIDs (such as 0 for
root) unless there is a specific operational requirement and strong
authorization controls are in place.<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">GSS-API exported names</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.4">
            <p id="section-5.2-2.4.1">The nameValue field should contain a properly formatted exported name
token as defined by the specific GSS-API mechanism. For Kerberos, this
follows the format specified in <span>[<a href="#RFC4121" class="cite xref">RFC4121</a>]</span>. Consult the mechanism
specification for proper encoding.<a href="#section-5.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">User@domain strings</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.6">
            <p id="section-5.2-2.6.1">Both the user and domain components should be UTF-8 encoded. Domain names
should typically match the DNS domain under which the server operates.
International domain names should be encoded in UTF-8, not in Punycode
(ACE) form.<a href="#section-5.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="certificate-validity-period">
<section id="section-5.3">
        <h3 id="name-certificate-validity-period">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-certificate-validity-period" class="section-name selfRef">Certificate Validity Period</a>
        </h3>
<p id="section-5.3-1">Certificates containing identity squashing otherName fields grant access
to server resources under a specific user identity. Administrators should
consider appropriate validity periods based on their security requirements.
Shorter validity periods reduce the window of exposure if a certificate is
compromised, but may increase operational overhead for certificate renewal.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The choice of validity period might also consider whether certificate
revocation checking (CRL or OCSP) is deployed and how quickly revocation
information propagates in the environment.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-6">
      <h2 id="name-implementation-status">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<aside id="section-6-1">
        <p id="section-6-1.1">RFC Editor: This section is to be removed before publishing this document as an RFC.<a href="#section-6-1.1" class="pilcrow">¶</a></p>
</aside>
<p id="section-6-2">This section records the status of known implementations of the
protocol defined by this specification at the time of posting of this
Internet-Draft, and is based on a proposal described in
<span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>. The description of implementations in this section is
intended to assist the IETF in its decision processes in progressing
drafts to RFCs.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Please note that the listing of any individual implementation here
does not imply endorsement by the IETF. Furthermore, no effort has
been spent to verify the information presented here that was supplied
by IETF contributors. This is not intended as, and must not be
construed to be, a catalog of available implementations or their
features. Readers are advised to note that other implementations may
exist.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="freebsd-nfs-server-and-client">
<section id="section-6.1">
        <h3 id="name-freebsd-nfs-server-and-clie">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-freebsd-nfs-server-and-clie" class="section-name selfRef">FreeBSD NFS Server and Client</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-6.1-1">
          <dt id="section-6.1-1.1">Organization:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.2">
            <p id="section-6.1-1.2.1">FreeBSD<a href="#section-6.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.3">URL:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.4">
            <p id="section-6.1-1.4.1"><a href="https://www.freebsd.org">https://www.freebsd.org</a><a href="#section-6.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.5">Maturity:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.6">
            <p id="section-6.1-1.6.1">Complete.<a href="#section-6.1-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.7">Coverage:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.8">
            <p id="section-6.1-1.8.1">The mechanism to represent user@domain strings has been implemented
using an OID from the FreeBSD arc.<a href="#section-6.1-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.9">Licensing:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.10">
            <p id="section-6.1-1.10.1">BSD 3-clause<a href="#section-6.1-1.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-1.11">Implementation experience:</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-1.12">
            <p id="section-6.1-1.12.1">None to report<a href="#section-6.1-1.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="general-security-considerations">
<section id="section-7.1">
        <h3 id="name-general-security-considerat">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-general-security-considerat" class="section-name selfRef">General Security Considerations</a>
        </h3>
<p id="section-7.1-1">The security considerations for RPC-with-TLS described in <span><a href="https://rfc-editor.org/rfc/rfc9289#section-8" class="relref">Section 8</a> of [<a href="#RFC9289" class="cite xref">RFC9289</a>]</span>
apply to this specification. In particular, the discussion about certificate
validation, trust anchors, and the establishment of secure TLS sessions remains
relevant.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identity-squashing-and-authorization">
<section id="section-7.2">
        <h3 id="name-identity-squashing-and-auth">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-identity-squashing-and-auth" class="section-name selfRef">Identity Squashing and Authorization</a>
        </h3>
<p id="section-7.2-1">This specification enables a client to request that all RPC operations within a
TLS session be executed under a single user identity specified in the client's
X.509 certificate. This "identity squashing" mechanism has several security
implications:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="trust-in-the-certificate-authority">
<section id="section-7.2.1">
          <h4 id="name-trust-in-the-certificate-au">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-trust-in-the-certificate-au" class="section-name selfRef">Trust in the Certificate Authority</a>
          </h4>
<p id="section-7.2.1-1">The server <span class="bcp14">MUST</span> carefully consider which Certificate Authorities (CAs) it trusts
to issue certificates containing the otherName extensions defined in this document.
A compromised or malicious CA could issue certificates that allow unauthorized
access to server resources under arbitrary user identities.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">Servers <span class="bcp14">SHOULD</span> maintain separate trust anchors for certificates containing
identity squashing otherName fields versus certificates used solely for TLS
peer authentication. This allows administrators to tightly control which CAs
are authorized to assert user identities.<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorization-decisions">
<section id="section-7.2.2">
          <h4 id="name-authorization-decisions">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-authorization-decisions" class="section-name selfRef">Authorization Decisions</a>
          </h4>
<p id="section-7.2.2-1">The presence of an otherName field specifying a user identity does not by itself
grant any authorization. Servers <span class="bcp14">MUST</span> perform their normal authorization checks
to determine whether the requested identity is permitted for the authenticated
TLS peer.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">For example, a server might maintain an access control list mapping certificate
subjects or distinguished names to the set of user identities they are permitted
to assume. Only if such authorization succeeds should the server execute RPC
operations under the specified identity.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="name-canonicalization">
<section id="section-7.2.3">
          <h4 id="name-name-canonicalization">
<a href="#section-7.2.3" class="section-number selfRef">7.2.3. </a><a href="#name-name-canonicalization" class="section-name selfRef">Name Canonicalization</a>
          </h4>
<div id="nfsv4-principals">
<section id="section-7.2.3.1">
            <h5 id="name-nfsv4-principals">
<a href="#section-7.2.3.1" class="section-number selfRef">7.2.3.1. </a><a href="#name-nfsv4-principals" class="section-name selfRef">NFSv4 Principals</a>
            </h5>
<p id="section-7.2.3.1-1">When processing NFSv4Principal otherName values, servers <span class="bcp14">MUST</span> apply the same
name canonicalization and domain validation procedures described in
<span><a href="https://rfc-editor.org/rfc/rfc8881#section-5.9" class="relref">Section 5.9</a> of [<a href="#RFC8881" class="cite xref">RFC8881</a>]</span>. In particular:<a href="#section-7.2.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.3.1-2.1">
                <p id="section-7.2.3.1-2.1.1">Domain names <span class="bcp14">SHOULD</span> be validated against expected domain suffixes<a href="#section-7.2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.1-2.2">
                <p id="section-7.2.3.1-2.2.1">Internationalized domain names <span class="bcp14">MUST</span> be properly normalized<a href="#section-7.2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.1-2.3">
                <p id="section-7.2.3.1-2.3.1">Case-sensitivity rules for usernames and domains <span class="bcp14">MUST</span> be consistently applied<a href="#section-7.2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="gss-api-exported-names">
<section id="section-7.2.3.2">
            <h5 id="name-gss-api-exported-names">
<a href="#section-7.2.3.2" class="section-number selfRef">7.2.3.2. </a><a href="#name-gss-api-exported-names" class="section-name selfRef">GSS-API Exported Names</a>
            </h5>
<p id="section-7.2.3.2-1">When processing GSSExportedName otherName values, servers <span class="bcp14">MUST</span> verify that:<a href="#section-7.2.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.3.2-2.1">
                <p id="section-7.2.3.2-2.1.1">The mechanism OID in the nameType field corresponds to a GSS-API mechanism
the server supports and trusts<a href="#section-7.2.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.2-2.2">
                <p id="section-7.2.3.2-2.2.1">The nameValue field conforms to the exported name format defined by that
specific GSS-API mechanism<a href="#section-7.2.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.2-2.3">
                <p id="section-7.2.3.2-2.3.1">The mechanism-specific name validation and canonicalization procedures are
followed<a href="#section-7.2.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.2.3.2-3">Servers <span class="bcp14">SHOULD NOT</span> accept exported names from GSS-API mechanisms they do not
fully support, as improper name handling could lead to authorization bypass
vulnerabilities.<a href="#section-7.2.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authsys-credentials">
<section id="section-7.2.3.3">
            <h5 id="name-auth_sys-credentials">
<a href="#section-7.2.3.3" class="section-number selfRef">7.2.3.3. </a><a href="#name-auth_sys-credentials" class="section-name selfRef">AUTH_SYS Credentials</a>
            </h5>
<p id="section-7.2.3.3-1">When processing RPCAuthSys otherName values, servers <span class="bcp14">MUST</span>:<a href="#section-7.2.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.3.3-2.1">
                <p id="section-7.2.3.3-2.1.1">Validate that the UID and GIDs fall within acceptable ranges for the local
system's user database<a href="#section-7.2.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.3-2.2">
                <p id="section-7.2.3.3-2.2.1">Verify that the UID corresponds to a valid user account<a href="#section-7.2.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.2.3.3-2.3">
                <p id="section-7.2.3.3-2.3.1">Confirm that the GIDs represent valid groups and that the user is authorized
to be a member of those groups<a href="#section-7.2.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-7.2.3.3-3">Servers <span class="bcp14">SHOULD</span> reject certificates containing UID 0 (root) or other privileged
UIDs unless there is an explicit and well-justified operational requirement,
and additional strong authorization controls are in place.<a href="#section-7.2.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="session-binding">
<section id="section-7.3">
        <h3 id="name-session-binding">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-session-binding" class="section-name selfRef">Session Binding</a>
        </h3>
<p id="section-7.3-1">All RPC operations within a TLS session containing an identity squashing otherName
execute under the same user identity. Servers <span class="bcp14">MUST</span> ensure that session state
cannot be hijacked or transferred between different TLS sessions, as this could
allow an attacker to gain the privileges associated with the squashed identity.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocation">
<section id="section-7.4">
        <h3 id="name-revocation">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-revocation" class="section-name selfRef">Revocation</a>
        </h3>
<p id="section-7.4-1">Servers <span class="bcp14">SHOULD</span> support certificate revocation checking (via CRL, OCSP, or similar
mechanisms) for certificates containing identity squashing otherName fields.
Since these certificates grant user-level access to server resources, timely
revocation is critical when a certificate is compromised or a user's access
should be terminated.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7.5">
        <h3 id="name-privacy-considerations">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-7.5-1">The otherName fields defined in this specification reveal user identity information
in the client's X.509 certificate. This information is transmitted during the TLS
handshake and may be visible to network observers if the handshake is not properly
protected.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">While TLS 1.3 encrypts most of the handshake including certificates, earlier TLS
versions may expose this information. Deployments concerned about privacy <span class="bcp14">SHOULD</span>
use TLS 1.3 or later.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-identity-formats">
<section id="section-7.6">
        <h3 id="name-multiple-identity-formats">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-multiple-identity-formats" class="section-name selfRef">Multiple Identity Formats</a>
        </h3>
<p id="section-7.6-1">Implementations <span class="bcp14">MUST NOT</span> allow multiple identity squashing otherName fields to be
present simultaneously in the same SubjectAltName extension. If multiple such
fields are present (e.g., both RPCAuthSys and NFSv4Principal), the server <span class="bcp14">MUST</span>
reject the certificate to avoid ambiguity about which identity should be used.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="smi-security-for-pkix-module-identifier">
<section id="section-8.1">
        <h3 id="name-smi-security-for-pkix-modul">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-smi-security-for-pkix-modul" class="section-name selfRef">SMI Security for PKIX Module Identifier</a>
        </h3>
<p id="section-8.1-1">IANA is requested to assign three object identifiers for the ASN.1 modules
specified in this document in the "SMI Security for PKIX Module Identifier"
registry (1.3.6.1.5.5.7.0):<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">id-mod-rpc-auth-sys</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD2</td>
              <td class="text-left" rowspan="1" colspan="1">id-mod-gss-exported-name</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD3</td>
              <td class="text-left" rowspan="1" colspan="1">id-mod-nfsv4-principal</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="smi-security-for-pkix-other-name-forms">
<section id="section-8.2">
        <h3 id="name-smi-security-for-pkix-other">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-smi-security-for-pkix-other" class="section-name selfRef">SMI Security for PKIX Other Name Forms</a>
        </h3>
<p id="section-8.2-1">IANA is requested to assign three object identifiers for the otherName
types specified in this document in the "SMI Security for PKIX Other
Name Forms" registry (1.3.6.1.5.5.7.8):<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD4</td>
              <td class="text-left" rowspan="1" colspan="1">id-on-rpcAuthSys</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD5</td>
              <td class="text-left" rowspan="1" colspan="1">id-on-gssExportedName</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD6</td>
              <td class="text-left" rowspan="1" colspan="1">id-on-nfsv4Principal</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-TBD</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.2-3">These otherName identifiers are used in the SubjectAltName extension
of X.509 certificates to carry RPC user identity information for the
purpose of identity squashing as described in this document.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">"RFC-TBD" is to be replaced with the actual RFC number when this
document is published.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9289">[RFC9289]</dt>
      <dd>
<span class="refAuthor">Myklebust, T.</span> and <span class="refAuthor">C. Lever, Ed.</span>, <span class="refTitle">"Towards Remote Procedure Call Encryption by Default"</span>, <span class="seriesInfo">RFC 9289</span>, <span class="seriesInfo">DOI 10.17487/RFC9289</span>, <time datetime="2022-09" class="refDate">September 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9289">https://www.rfc-editor.org/rfc/rfc9289</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2743">[RFC2743]</dt>
        <dd>
<span class="refAuthor">Linn, J.</span>, <span class="refTitle">"Generic Security Service Application Program Interface Version 2, Update 1"</span>, <span class="seriesInfo">RFC 2743</span>, <span class="seriesInfo">DOI 10.17487/RFC2743</span>, <time datetime="2000-01" class="refDate">January 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2743">https://www.rfc-editor.org/rfc/rfc2743</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4121">[RFC4121]</dt>
        <dd>
<span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Jaganathan, K.</span>, and <span class="refAuthor">S. Hartman</span>, <span class="refTitle">"The Kerberos Version 5 Generic Security Service Application Program Interface (GSS-API) Mechanism: Version 2"</span>, <span class="seriesInfo">RFC 4121</span>, <span class="seriesInfo">DOI 10.17487/RFC4121</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4121">https://www.rfc-editor.org/rfc/rfc4121</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5531">[RFC5531]</dt>
        <dd>
<span class="refAuthor">Thurlow, R.</span>, <span class="refTitle">"RPC: Remote Procedure Call Protocol Specification Version 2"</span>, <span class="seriesInfo">RFC 5531</span>, <span class="seriesInfo">DOI 10.17487/RFC5531</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5531">https://www.rfc-editor.org/rfc/rfc5531</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8881">[RFC8881]</dt>
      <dd>
<span class="refAuthor">Noveck, D., Ed.</span> and <span class="refAuthor">C. Lever</span>, <span class="refTitle">"Network File System (NFS) Version 4 Minor Version 1 Protocol"</span>, <span class="seriesInfo">RFC 8881</span>, <span class="seriesInfo">DOI 10.17487/RFC8881</span>, <time datetime="2020-08" class="refDate">August 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8881">https://www.rfc-editor.org/rfc/rfc8881</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="asn1-modules">
<section id="appendix-A">
      <h2 id="name-asn1-modules">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-modules" class="section-name selfRef">ASN.1 Modules</a>
      </h2>
<p id="appendix-A-1">The following ASN.1 modules normatively specify the structure of
the new otherName values described in this document.
This specification uses the ASN.1 definitions from
<span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span> with the 2002 ASN.1 notation used in that document.
<span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span> updates normative documents using older ASN.1 notation.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="sec-authsys-asn1">
<section id="appendix-A.1">
        <h3 id="name-the-rpcauthsysuser">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-the-rpcauthsysuser" class="section-name selfRef">The RpcAuthSysUser</a>
        </h3>
<div class="lang-asn.1 sourcecode" id="appendix-A.1-1">
<pre>
RPCAuthSysCertExtn
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-rpc-auth-sys(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
    OTHER-NAME
    FROM PKIX1Implicit-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkix1-implicit-02(59) } ;

-- Object Identifier Arc
id-pkix OBJECT IDENTIFIER ::=
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) }

id-on OBJECT IDENTIFIER ::= { id-pkix 8 }  -- other names

-- OID for RPC AUTH_SYS credentials in otherName
id-on-rpcAuthSys OBJECT IDENTIFIER ::= { id-on TBD }

-- RPC AUTH_SYS Credentials Structure
-- UID and GID list as used in RPC AUTH_SYS authentication flavor
-- See RFC 5531 (ONC RPC) and related specifications
RPCAuthSys ::= SEQUENCE {
    uid        INTEGER (0..4294967295),  -- 32-bit UID
    gids       SEQUENCE OF INTEGER (0..4294967295)  -- List of 32-bit GIDs
}

-- For use in SubjectAltName otherName
rpcAuthSys OTHER-NAME ::= {
    RPCAuthSys IDENTIFIED BY id-on-rpcAuthSys
}

END
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-gss-asn1">
<section id="appendix-A.2">
        <h3 id="name-the-rpcgssuser">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-the-rpcgssuser" class="section-name selfRef">The RpcGssUser</a>
        </h3>
<div class="lang-asn.1 sourcecode" id="appendix-A.2-1">
<pre>
GSSAPIPrincipalCertExtn
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-gss-exported-name(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
    OTHER-NAME
    FROM PKIX1Implicit-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkix1-implicit-02(59) } ;

-- Object Identifier Arc
id-pkix OBJECT IDENTIFIER ::=
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) }

id-on OBJECT IDENTIFIER ::= { id-pkix 8 }  -- other names

-- OID for GSS-API Exported Name in otherName
id-on-gssExportedName OBJECT IDENTIFIER ::= { id-on TBD }

-- GSS-API Exported Name Structure
-- As defined in RFC 2743 Section 3.2
GSSExportedName ::= SEQUENCE {
    nameType   OBJECT IDENTIFIER,  -- GSS-API mechanism OID
    nameValue  OCTET STRING        -- Mechanism-specific exported name
}

-- For use in SubjectAltName otherName
gssExportedName OTHER-NAME ::= {
    GSSExportedName IDENTIFIED BY id-on-gssExportedName
}

END
</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec-nfsv4-asn1">
<section id="appendix-A.3">
        <h3 id="name-the-rpcnfsv4user">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-the-rpcnfsv4user" class="section-name selfRef">The RpcNfsv4User</a>
        </h3>
<div class="lang-asn.1 sourcecode" id="appendix-A.3-1">
<pre>
NFSv4PrincipalCertExtn
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-nfsv4-principal(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
    OTHER-NAME
    FROM PKIX1Implicit-2009
        { iso(1) identified-organization(3) dod(6) internet(1)
          security(5) mechanisms(5) pkix(7) id-mod(0)
          id-mod-pkix1-implicit-02(59) } ;

-- Object Identifier Arc
id-pkix OBJECT IDENTIFIER ::=
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) }

id-on OBJECT IDENTIFIER ::= { id-pkix 8 }  -- other names

-- OID for NFSv4 user@domain principal in otherName
id-on-nfsv4Principal OBJECT IDENTIFIER ::= { id-on TBD }

-- NFSv4 User@Domain Principal Structure
-- As defined in RFC 8881 Section 5.9
NFSv4Principal ::= SEQUENCE {
    user       UTF8String,
    atSign     IA5String (SIZE (1)) (FROM ("@")),
    domain     UTF8String  -- Supports internationalized domain names
}

-- For use in SubjectAltName otherName
nfsv4Principal OTHER-NAME ::= {
    NFSv4Principal IDENTIFIED BY id-on-nfsv4Principal
}

END
</pre><a href="#appendix-A.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-certificate-examples">
<section id="appendix-B">
      <h2 id="name-certificate-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-certificate-examples" class="section-name selfRef">Certificate Examples</a>
      </h2>
<p id="appendix-B-1">This appendix provides examples of X.509 certificates containing the
otherName extensions defined in this document. These examples are
provided in both human-readable notation and hexadecimal DER encoding
to assist implementers in verifying their implementations.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="nfsv4-principal-example">
<section id="appendix-B.1">
        <h3 id="name-nfsv4-principal-example">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-nfsv4-principal-example" class="section-name selfRef">NFSv4 Principal Example</a>
        </h3>
<p id="appendix-B.1-1">This example shows a certificate for user "alice" at domain "nfs.example.com":<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-B.1-2">
<pre>
SubjectAltName ::= SEQUENCE {
    otherName [0] IMPLICIT SEQUENCE {
        type-id OBJECT IDENTIFIER ::= id-on-nfsv4Principal,
        value [0] EXPLICIT NFSv4Principal ::= {
            user "alice",
            atSign "@",
            domain "nfs.example.com"
        }
    }
}
</pre><a href="#appendix-B.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-3">DER encoding (hexadecimal):<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-4">
<pre>
30 2B A0 29 06 08 2B 06 01 05 05 07 08 XX A0 1D
0C 05 61 6C 69 63 65 13 01 40 0C 0F 6E 66 73 2E
65 78 61 6D 70 6C 65 2E 63 6F 6D
</pre><a href="#appendix-B.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-5">Note: XX represents the TBD value for id-on-nfsv4Principal.<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gss-api-exported-name-example">
<section id="appendix-B.2">
        <h3 id="name-gss-api-exported-name-examp">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-gss-api-exported-name-examp" class="section-name selfRef">GSS-API Exported Name Example</a>
        </h3>
<p id="appendix-B.2-1">This example shows a certificate containing a Kerberos V5 principal
for "bob@EXAMPLE.COM":<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-B.2-2">
<pre>
SubjectAltName ::= SEQUENCE {
    otherName [0] IMPLICIT SEQUENCE {
        type-id OBJECT IDENTIFIER ::= id-on-gssExportedName,
        value [0] EXPLICIT GSSExportedName ::= {
            nameType 1.2.840.113554.1.2.2,  -- Kerberos V5
            nameValue '04 01 00 0B 06 09 2A 86 48 86 F7 12 01 02 02
                       00 00 00 11 62 6F 62 40 45 58 41 4D 50 4C 45
                       2E 43 4F 4D'H
        }
    }
}
</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-3">DER encoding (hexadecimal):<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-4">
<pre>
30 47 A0 45 06 08 2B 06 01 05 05 07 08 YY A0 39
30 37 06 09 2A 86 48 86 F7 12 01 02 02 04 2A 04
01 00 0B 06 09 2A 86 48 86 F7 12 01 02 02 00 00
00 11 62 6F 62 40 45 58 41 4D 50 4C 45 2E 43 4F
4D
</pre><a href="#appendix-B.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-5">Note: YY represents the TBD value for id-on-gssExportedName.<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<p id="appendix-B.2-6">The nameValue field contains the GSS-API exported name token format
as defined by the Kerberos V5 mechanism. The first four bytes
(04 01 00 0B) are the token ID and length fields defined in
<span><a href="https://rfc-editor.org/rfc/rfc2743#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC2743" class="cite xref">RFC2743</a>]</span>.<a href="#appendix-B.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rpc-authsys-example">
<section id="appendix-B.3">
        <h3 id="name-rpc-auth_sys-example">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-rpc-auth_sys-example" class="section-name selfRef">RPC AUTH_SYS Example</a>
        </h3>
<p id="appendix-B.3-1">This example shows a certificate containing UID 1000 and GIDs
1000, 10, and 100:<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-B.3-2">
<pre>
SubjectAltName ::= SEQUENCE {
    otherName [0] IMPLICIT SEQUENCE {
        type-id OBJECT IDENTIFIER ::= id-on-rpcAuthSys,
        value [0] EXPLICIT RPCAuthSys ::= {
            uid 1000,
            gids { 1000, 10, 100 }
        }
    }
}
</pre><a href="#appendix-B.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-3">DER encoding (hexadecimal):<a href="#appendix-B.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-4">
<pre>
30 20 A0 1E 06 08 2B 06 01 05 05 07 08 ZZ A0 12
30 10 02 02 03 E8 30 0A 02 02 03 E8 02 01 0A 02
01 64
</pre><a href="#appendix-B.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-5">Note: ZZ represents the TBD value for id-on-rpcAuthSys.<a href="#appendix-B.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3-6">Breaking down the encoding:
- 02 02 03 E8: INTEGER 1000 (UID)
- 30 0A: SEQUENCE OF (GIDs)
  - 02 02 03 E8: INTEGER 1000
  - 02 01 0A: INTEGER 10
  - 02 01 64: INTEGER 100<a href="#appendix-B.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="complete-certificate-example">
<section id="appendix-B.4">
        <h3 id="name-complete-certificate-exampl">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-complete-certificate-exampl" class="section-name selfRef">Complete Certificate Example</a>
        </h3>
<p id="appendix-B.4-1">This example shows a minimal self-signed certificate containing an
NFSv4Principal otherName. Line breaks and whitespace have been added
for readability:<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-2">
<pre>
-----BEGIN CERTIFICATE-----
MIICXzCCAcigAwIBAgIUAbCdEfG7KH0FjLbI8N9cJQqQoLwwDQYJKoZIhvcNAQEL
BQAwRDELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExDzANBgNVBAcM
BklydmluZTEPMA0GA1UECgwGT3JhY2xlMB4XDTI1MDEwMTAwMDAwMFoXDTI2MDEw
MTAwMDAwMFowRDELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlmb3JuaWExDzAN
BgNVBAcMBklydmluZTEPMA0GA1UECgwGT3JhY2xlMIGfMA0GCSqGSIb3DQEBAQUA
A4GNADCBiQKBgQC7VJTUt9Us8cKjMzEfYyjiWA4R4ypbHqGC0H0+tG3hGbN3MYHa
... [additional base64-encoded certificate data] ...
oxUwEwYDVR0lBAwwCgYIKwYBBQUHAwEwKwYDVR0RBCQwIqAfBggrBgEFBQcIAKAT
DBVhbGljZUBuZnMuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQELBQADgYEAk3+...
-----END CERTIFICATE-----
</pre><a href="#appendix-B.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.4-3">The SubjectAltName extension in this certificate is encoded at the
position indicated by the bytes following the Extended Key Usage
extension.<a href="#appendix-B.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="internationalized-domain-name-example">
<section id="appendix-B.5">
        <h3 id="name-internationalized-domain-na">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-internationalized-domain-na" class="section-name selfRef">Internationalized Domain Name Example</a>
        </h3>
<p id="appendix-B.5-1">This example shows an NFSv4Principal with internationalized characters:<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="appendix-B.5-2">
<pre>
SubjectAltName ::= SEQUENCE {
    otherName [0] IMPLICIT SEQUENCE {
        type-id OBJECT IDENTIFIER ::= id-on-nfsv4Principal,
        value [0] EXPLICIT NFSv4Principal ::= {
            user "用户",        -- Chinese characters for "user"
            atSign "@",
            domain "例え.jp"    -- Japanese IDN
        }
    }
}
</pre><a href="#appendix-B.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.5-3">DER encoding (hexadecimal):<a href="#appendix-B.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.5-4">
<pre>
30 2D A0 2B 06 08 2B 06 01 05 05 07 08 XX A0 1F
0C 06 E7 94 A8 E6 88 B7 13 01 40 0C 0C E4 BE 8B
E3 81 88 2E 6A 70
</pre><a href="#appendix-B.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.5-5">Note: The UTF-8 encoding of the Chinese characters "用户" is
E7 94 A8 E6 88 B7, and the Japanese text "例え" is E4 BE 8B E3 81 88.<a href="#appendix-B.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-vectors">
<section id="appendix-B.6">
        <h3 id="name-test-vectors">
<a href="#appendix-B.6" class="section-number selfRef">B.6. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
        </h3>
<p id="appendix-B.6-1">This section provides test vectors for validating implementations.
Each test case includes the input values, expected ASN.1 structure,
and expected DER encoding.<a href="#appendix-B.6-1" class="pilcrow">¶</a></p>
<div id="valid-nfsv4principal-test-cases">
<section id="appendix-B.6.1">
          <h4 id="name-valid-nfsv4principal-test-c">
<a href="#appendix-B.6.1" class="section-number selfRef">B.6.1. </a><a href="#name-valid-nfsv4principal-test-c" class="section-name selfRef">Valid NFSv4Principal Test Cases</a>
          </h4>
<p id="appendix-B.6.1-1">Test Case 1: Simple ASCII user and domain<a href="#appendix-B.6.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.6.1-2">Input:<a href="#appendix-B.6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.1-3.1">
              <p id="appendix-B.6.1-3.1.1">user: "bob"<a href="#appendix-B.6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.1-3.2">
              <p id="appendix-B.6.1-3.2.1">domain: "example.org"<a href="#appendix-B.6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.1-4">Expected DER encoding:<a href="#appendix-B.6.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.6.1-5">
<pre>
30 22 A0 20 06 08 2B 06 01 05 05 07 08 XX A0 14
0C 03 62 6F 62 13 01 40 0C 0B 65 78 61 6D 70 6C
65 2E 6F 72 67
</pre><a href="#appendix-B.6.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.6.1-6">Test Case 2: User with numbers and domain with subdomain<a href="#appendix-B.6.1-6" class="pilcrow">¶</a></p>
<p id="appendix-B.6.1-7">Input:<a href="#appendix-B.6.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.1-8.1">
              <p id="appendix-B.6.1-8.1.1">user: "user123"<a href="#appendix-B.6.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.1-8.2">
              <p id="appendix-B.6.1-8.2.1">domain: "nfs.lab.example.com"<a href="#appendix-B.6.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.1-9">Expected DER encoding:<a href="#appendix-B.6.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.6.1-10">
<pre>
30 2F A0 2D 06 08 2B 06 01 05 05 07 08 XX A0 21
0C 07 75 73 65 72 31 32 33 13 01 40 0C 14 6E 66
73 2E 6C 61 62 2E 65 78 61 6D 70 6C 65 2E 63 6F
6D
</pre><a href="#appendix-B.6.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-rpcauthsys-test-cases">
<section id="appendix-B.6.2">
          <h4 id="name-valid-rpcauthsys-test-cases">
<a href="#appendix-B.6.2" class="section-number selfRef">B.6.2. </a><a href="#name-valid-rpcauthsys-test-cases" class="section-name selfRef">Valid RPCAuthSys Test Cases</a>
          </h4>
<p id="appendix-B.6.2-1">Test Case 1: Single user, single group<a href="#appendix-B.6.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.6.2-2">Input:<a href="#appendix-B.6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.2-3.1">
              <p id="appendix-B.6.2-3.1.1">uid: 1000<a href="#appendix-B.6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.2-3.2">
              <p id="appendix-B.6.2-3.2.1">gids: { 1000 }<a href="#appendix-B.6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.2-4">Expected DER encoding:<a href="#appendix-B.6.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.6.2-5">
<pre>
30 13 A0 11 06 08 2B 06 01 05 05 07 08 ZZ A0 05
30 08 02 02 03 E8 30 04 02 02 03 E8
</pre><a href="#appendix-B.6.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.6.2-6">Test Case 2: User with empty group list<a href="#appendix-B.6.2-6" class="pilcrow">¶</a></p>
<p id="appendix-B.6.2-7">Input:<a href="#appendix-B.6.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.2-8.1">
              <p id="appendix-B.6.2-8.1.1">uid: 500<a href="#appendix-B.6.2-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.2-8.2">
              <p id="appendix-B.6.2-8.2.1">gids: (empty)<a href="#appendix-B.6.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.2-9">Expected DER encoding:<a href="#appendix-B.6.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.6.2-10">
<pre>
30 0F A0 0D 06 08 2B 06 01 05 05 07 08 ZZ A0 01
30 06 02 02 01 F4 30 00
</pre><a href="#appendix-B.6.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-B.6.2-11">Test Case 3: User with maximum 32-bit UID and multiple groups<a href="#appendix-B.6.2-11" class="pilcrow">¶</a></p>
<p id="appendix-B.6.2-12">Input:<a href="#appendix-B.6.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.2-13.1">
              <p id="appendix-B.6.2-13.1.1">uid: 4294967295<a href="#appendix-B.6.2-13.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.2-13.2">
              <p id="appendix-B.6.2-13.2.1">gids: { 1, 10, 100, 1000 }<a href="#appendix-B.6.2-13.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.2-14">Expected DER encoding:<a href="#appendix-B.6.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.6.2-15">
<pre>
30 24 A0 22 06 08 2B 06 01 05 05 07 08 ZZ A0 16
30 14 02 05 00 FF FF FF FF 30 0B 02 01 01 02 01
0A 02 01 64 02 02 03 E8
</pre><a href="#appendix-B.6.2-15" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="invalid-test-cases">
<section id="appendix-B.6.3">
          <h4 id="name-invalid-test-cases">
<a href="#appendix-B.6.3" class="section-number selfRef">B.6.3. </a><a href="#name-invalid-test-cases" class="section-name selfRef">Invalid Test Cases</a>
          </h4>
<p id="appendix-B.6.3-1">These test cases should be rejected by conforming implementations:<a href="#appendix-B.6.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-2">Test Case 1: NFSv4Principal with missing atSign field<a href="#appendix-B.6.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-3">Input (malformed):<a href="#appendix-B.6.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.3-4.1">
              <p id="appendix-B.6.3-4.1.1">user: "alice"<a href="#appendix-B.6.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.3-4.2">
              <p id="appendix-B.6.3-4.2.1">atSign: "" (empty)<a href="#appendix-B.6.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.3-4.3">
              <p id="appendix-B.6.3-4.3.1">domain: "example.com"<a href="#appendix-B.6.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.3-5">Expected result: Parsing failure<a href="#appendix-B.6.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-6">Test Case 2: RPCAuthSys with UID exceeding 32-bit range<a href="#appendix-B.6.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-7">Input (malformed):<a href="#appendix-B.6.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.6.3-8.1">
              <p id="appendix-B.6.3-8.1.1">uid: 4294967296 (2^32)<a href="#appendix-B.6.3-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.6.3-8.2">
              <p id="appendix-B.6.3-8.2.1">gids: { 1000 }<a href="#appendix-B.6.3-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.6.3-9">Expected result: Encoding failure or rejection<a href="#appendix-B.6.3-9" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-10">Test Case 3: Certificate with multiple identity squashing otherNames<a href="#appendix-B.6.3-10" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-11">Input (malformed):
SubjectAltName containing both:
- id-on-nfsv4Principal with user "alice@example.com"
- id-on-rpcAuthSys with uid 1000<a href="#appendix-B.6.3-11" class="pilcrow">¶</a></p>
<p id="appendix-B.6.3-12">Expected result: Certificate rejection per Security Considerations<a href="#appendix-B.6.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors are grateful to
Jeff Layton,
Greg Marsden,
and
Martin Thomson
for their input and support.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Special thanks to
Area Director
Gorry Fairhurst,
NFSV4 Working Group Chairs
Brian Pawlowski
and
Christopher Inacio,
and
NFSV4 Working Group Secretary
Thomas Haynes
for their guidance and oversight.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rick Macklem</span></div>
<div dir="auto" class="left"><span class="org">FreeBSD Project</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rmacklem@uoguelph.ca" class="email">rmacklem@uoguelph.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chuck Lever (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Oracle Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chuck.lever@oracle.com" class="email">chuck.lever@oracle.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
